{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://cartographer/atlas/schemas/accessibility.schema.json#1",
  "title": "Accessibility Record",
  "description": "Accessibility audit data for a single page. Owner: Cai Frazier.",
  "type": "object",
  "required": ["pageUrl", "missingAltCount", "headingOrder", "landmarks", "roles"],
  "properties": {
    "pageUrl": {
      "type": "string",
      "format": "uri",
      "description": "The URL of the audited page"
    },
    "audit_engine": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of audit engine (e.g., 'cartographer-wcag', 'axe-core')"
        },
        "version": {
          "type": "string",
          "description": "Version of audit engine"
        }
      },
      "required": ["name", "version"],
      "additionalProperties": false,
      "description": "Audit engine identification for reproducibility"
    },
    "wcag_version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+$",
      "description": "Target WCAG standard version (e.g., '2.1', '2.2')"
    },
    "audit_profile": {
      "type": "string",
      "enum": ["basic", "essential", "full", "custom"],
      "description": "Depth of accessibility audit performed"
    },
    "audited_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when audit was performed"
    },
    "missingAltCount": {
      "type": "integer",
      "minimum": 0,
      "description": "Number of images with missing or empty alt attributes"
    },
    "missingAltSources": {
      "type": "array",
      "items": { "type": "string" },
      "maxItems": 50,
      "description": "Sample of image src values with missing alt (first 50)"
    },
    "headingOrder": {
      "type": "array",
      "items": { "enum": ["H1", "H2", "H3", "H4", "H5", "H6"] },
      "description": "Sequence of heading levels as they appear in DOM order"
    },
    "landmarks": {
      "type": "object",
      "properties": {
        "header": { "type": "boolean" },
        "nav": { "type": "boolean" },
        "main": { "type": "boolean" },
        "aside": { "type": "boolean" },
        "footer": { "type": "boolean" }
      },
      "additionalProperties": false,
      "description": "Presence of HTML5 landmark elements"
    },
    "roles": {
      "type": "object",
      "additionalProperties": { "type": "integer", "minimum": 0 },
      "description": "Count of elements by ARIA role attribute value"
    },
    "contrastViolations": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["selector", "ratio", "level"],
        "properties": {
          "selector": { "type": "string" },
          "fg": { "type": "string" },
          "bg": { "type": "string" },
          "ratio": { "type": "number", "minimum": 0 },
          "level": { "enum": ["AA", "AAA"] }
        },
        "additionalProperties": false
      },
      "description": "Sample of contrast violations (first 20 from first 200 visible elements)"
    },
    "ariaIssues": {
      "type": "array",
      "items": { "type": "string" },
      "maxItems": 50,
      "description": "Sample of ARIA-related issues detected"
    },
    "lang": {
      "type": ["string", "null"],
      "description": "Language attribute from html element"
    },
    "focusOrder": {
      "type": ["array", "null"],
      "items": {
        "type": "object",
        "additionalProperties": true
      },
      "description": "Tab order of focusable elements"
    },
    "formControls": {
      "type": ["object", "null"],
      "additionalProperties": true,
      "description": "Form control analysis"
    },
    "wcagData": {
      "type": ["object", "null"],
      "additionalProperties": true,
      "description": "Runtime WCAG audit data from full mode"
    }
  },
  "additionalProperties": false
}
