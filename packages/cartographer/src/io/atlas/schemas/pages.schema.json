{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://spec.continuum.local/atlas/pages.schema.json#1",
  "title": "PageRecord",
  "description": "Page crawl record for Atlas v1.0 - Owner: Cai Frazier",
  "type": "object",
  "required": [
    "url",
    "finalUrl",
    "normalizedUrl",
    "urlKey",
    "origin",
    "pathname",
    "statusCode",
    "fetchedAt",
    "rawHtmlHash",
    "title",
    "renderMode",
    "depth",
    "discoveredInMode"
  ],
  "additionalProperties": false,
  "properties": {
    "url": { "type": "string" },
    "finalUrl": { "type": "string" },
    "normalizedUrl": { "type": "string" },
    "urlKey": { "type": "string" },
    "origin": { "type": "string" },
    "pathname": { "type": "string" },
    "statusCode": { "type": "integer" },
    "fetchedAt": { "type": "string", "format": "date-time" },
    "rawHtmlHash": { "type": "string" },
    "domHash": { "type": "string" },
    "title": { "type": "string" },
    "metaDescription": { "type": ["string", "null"] },
      "section": { "type": "string" },
      "contentType": { "type": ["string", "null"] },
      "redirectChain": {
        "type": ["array", "null"],
        "items": { "type": "string" }
      },
      "canonicalHref": { "type": ["string", "null"] },
      "canonicalResolved": { "type": ["string", "null"] },
      "noindexSurface": {
        "type": ["string", "null"],
        "enum": ["meta", "header", "both", null]
      },
      "fetchMs": { "type": "integer" },
      "internalLinksCount": { "type": "integer" },
      "externalLinksCount": { "type": "integer" },
      "mediaAssetsCount": { "type": "integer" },
      "mediaAssetsTruncated": { "type": "boolean" },
      "hreflangLinks": {
        "type": ["array", "null"],
        "items": {
          "type": "object",
          "properties": {
            "href": { "type": "string" },
            "lang": { "type": "string" }
          },
          "required": ["href", "lang"],
          "additionalProperties": false
        }
      },
      "discoveredFrom": { "type": ["string", "null"] },
      "basicFlags": {
        "type": "object",
        "properties": {
          "hasTitle": { "type": "boolean" },
          "hasMetaDescription": { "type": "boolean" },
          "hasH1": { "type": "boolean" },
          "hasCanonical": { "type": "boolean" }
        },
        "required": ["hasTitle", "hasMetaDescription", "hasH1", "hasCanonical"],
        "additionalProperties": false
      },
    "h1": { "type": "string" },
    "headings": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["level", "text"],
        "properties": {
          "level": { "type": "integer", "minimum": 1, "maximum": 6 },
          "text": { "type": "string" }
        }
      }
    },
    "canonical": { "type": "string" },
    "robotsMeta": { "type": "string" },
    "robotsHeader": { "type": "string" },
    "textSample": { "type": "string" },
    "renderMode": {
      "type": "string",
      "enum": ["raw", "prerender", "full"]
    },
    "renderMs": { "type": "integer" },
    "navEndReason": {
  "type": "string",
  "enum": ["load", "domcontentloaded", "networkidle", "timeout", "error", "fetch"]
    },
    "depth": { "type": "integer", "minimum": 0 },
    "discoveredInMode": {
      "type": "string",
      "enum": ["raw", "prerender", "full"]
    },
    "error": { "type": "string" },
    "faviconUrl": { "type": ["string", "null"] },
    "techStack": {
      "type": ["array", "null"],
      "items": { "type": "string" }
    },
    "technologies": {
      "type": ["array", "null"],
      "items": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "version": { "type": ["string", "null"] },
          "categories": {
            "type": ["array", "null"],
            "items": { "type": "string" }
          }
        },
        "required": ["name"],
        "additionalProperties": false
      }
    },
    "openGraph": {
      "type": ["object", "null"],
      "properties": {
        "ogTitle": { "type": ["string", "null"] },
        "ogDescription": { "type": ["string", "null"] },
        "ogImage": { "type": ["string", "null"] },
        "ogUrl": { "type": ["string", "null"] },
        "ogType": { "type": ["string", "null"] },
        "ogSiteName": { "type": ["string", "null"] },
        "ogLocale": { "type": ["string", "null"] }
      },
      "additionalProperties": true
    },
    "twitterCard": {
      "type": ["object", "null"],
      "properties": {
        "twitterCard": { "type": ["string", "null"] },
        "twitterSite": { "type": ["string", "null"] },
        "twitterCreator": { "type": ["string", "null"] },
        "twitterTitle": { "type": ["string", "null"] },
        "twitterDescription": { "type": ["string", "null"] },
        "twitterImage": { "type": ["string", "null"] }
      },
      "additionalProperties": true
    },
    "structuredData": {
      "type": ["array", "null"],
      "items": {
        "type": "object",
        "additionalProperties": true
      }
    },
    "viewportMeta": {
      "type": ["object", "null"],
      "properties": {
        "width": { "type": ["string", "number", "null"] },
        "initialScale": { "type": ["string", "number", "null"] },
        "minimumScale": { "type": ["string", "number", "null"] },
        "maximumScale": { "type": ["string", "number", "null"] },
        "userScalable": { "type": ["string", "boolean", "null"] }
      },
      "additionalProperties": true
    },
    "enhancedSEO": {
      "type": ["object", "null"],
      "additionalProperties": true
    },
    "seo": {
      "type": ["object", "null"],
      "additionalProperties": true
    },
    "performance": {
      "type": ["object", "null"],
      "additionalProperties": true
    },
    "network": {
      "type": ["object", "null"],
      "additionalProperties": true
    },
    "resourceCounts": {
      "type": ["object", "null"],
      "additionalProperties": true
    },
    "compression": {
      "type": ["object", "null"],
      "additionalProperties": true
    },
    "subresourceIntegrity": {
      "type": ["object", "null"],
      "additionalProperties": true
    },
    "media": {
      "type": ["object", "null"],
      "properties": {
        "screenshots": {
          "type": ["object", "null"],
          "properties": {
            "desktop": { "type": ["string", "null"] },
            "mobile": { "type": ["string", "null"] }
          },
          "additionalProperties": false
        },
        "favicon": { "type": ["string", "null"] }
      },
      "additionalProperties": false
    },
    "screenshotFile": { "type": ["string", "null"] },
    "viewportFile": { "type": ["string", "null"] },
    "challengePageCaptured": { "type": ["boolean", "null"] }
  }
}
